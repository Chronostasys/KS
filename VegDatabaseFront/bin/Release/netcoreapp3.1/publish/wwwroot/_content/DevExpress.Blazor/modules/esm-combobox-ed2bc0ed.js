import"./esm-chunk-eaca7b99.js";import{EnsureElement as e,SetPositionOfDropDown as t,AttachEventToElement as o,elementIsInDOM as n,DetachEventFromElement as s}from"./esm-dom-utils-0302a1f6.js";import"./esm-chunk-5735fd9a.js";import{D as r,R as u}from"./esm-chunk-b0b509fc.js";import{T as a}from"./esm-chunk-95f7350d.js";import{K as i}from"./esm-chunk-6d4715b2.js";import"./esm-chunk-95f069f9.js";import"./esm-popup-utils-bda5791c.js";import{OnOutsideClick as c,IsDropDownVisible as m}from"./esm-dropdowns-814f3126.js";import{AttachEventsForFocusHiding as d}from"./esm-focus-utils-295d95eb.js";import{S as f,H as l,G as p}from"./esm-chunk-f341cf20.js";import{K as k,a as y}from"./esm-chunk-511b3c8e.js";function v(e){var t=D(e);f(t)}function C(t){t=e(t),document.activeElement===t&&h(t)}function w(e,t){e.dataset.timerId&&(clearTimeout(e.dataset.timerId),delete e.dataset.timerId),t||window.setTimeout((function(){w(e,!0)}),100)}function h(e){e&&e.dataset.focusedClass&&(e.className=e.dataset.focusedClass)}function b(e,t){return t&&k(e),function(e){return T(e)}(e)&&(e.stopPropagation(),e.preventDefault()),!1}function j(e,t,o,n){var s=!1;if(n&&(s=s||y(e)),s=s||function(e){var t=e.altKey&&(e.keyCode==i.Down||e.keyCode==i.Up),o=T(e),n=e.keyCode==i.Esc||e.keyCode==i.Enter;return t||o||n}(e)){var r=e.target.value;if(o&&l(o)){var u=p(o,!1);t.invokeMethodAsync("OnComboBoxListBoxKeyUp",r,e.keyCode,e.altKey,e.ctrlKey,u.itemHeight,u.scrollTopForRequest,u.scrollHeightForRequest)}else t.invokeMethodAsync("OnComboBoxKeyUp",r,e.keyCode,e.altKey,e.ctrlKey)}}function T(e){return e.keyCode===i.Down||e.keyCode===i.Up||e.keyCode===i.PageUp||e.keyCode===i.PageDown||e.ctrlKey&&(e.keyCode===i.Home||e.keyCode===i.End)}function g(e,t,o){if(t){var n=(new Date).getTime();t.dataset.lastLostFocusTime&&n-t.dataset.lastLostFocusTime<300&&!o||(t.dataset.lastLostFocusTime=(new Date).getTime(),e.invokeMethodAsync("OnComboBoxLostFocus",t.value))}}function D(t){return(t=e(t)).querySelector("div.dxbs-dm.dropdown-menu")}function I(i,f,l,p,k){if(i=e(i)){r(i),p="true"===p.toLowerCase(),k="true"===k.toLowerCase(),f=e(f);var y=D(i);t(i,y);var C=y;k&&v(i);var T=function(e){return b(e,p)},I=function(e){return j(e,l,C,p)},K=function(e){return function(e,t){h(e.target)}(e)},E=function(e){return function(e,t){var o=e.target;w(o,!0),o.dataset.timerId=window.setTimeout((function(){if(delete o.dataset.timerId,function(e){e&&e.dataset.bluredClass&&(e.className=e.dataset.bluredClass)}(o),document.activeElement!==o)try{g(t,o)}catch(e){}}),200)}(e,l)},x=function(e){return w(f)},F=function(e){return c(e,i,(function(){n(i)||r(i);var e=document.activeElement===f,t=f.dataset.timerId>0,o=y&&m(y);w(f),(e||t||o)&&g(l,f,!0)}))};return o(f,"keydown",T),o(f,"keyup",I),o(f,"focus",K),o(f,"blur",E),o(i,"mousedown",x),o(document,a.touchMouseDownEventName,F),d(i),u(i,(function(){s(f,"keydown",T),s(f,"keyup",I),s(f,"focus",K),s(f,"blur",E),s(i,"mousedown",x),s(document,a.touchMouseDownEventName,F)})),Promise.resolve("ok")}}function K(t){if(t=e(t))return r(t),Promise.resolve("ok")}const E={Init:I,Dispose:K,PrepareInputIfFocused:C,ScrollToSelectedItem:v};export default E;export{K as Dispose,I as Init,C as PrepareInputIfFocused,v as ScrollToSelectedItem};
