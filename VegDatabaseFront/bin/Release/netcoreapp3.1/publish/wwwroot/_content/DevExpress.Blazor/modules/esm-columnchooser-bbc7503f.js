import"./esm-chunk-eaca7b99.js";import{EnsureElement as n,EraseBlazorIdentificators as e}from"./esm-dom-utils-0302a1f6.js";import"./esm-chunk-5735fd9a.js";import"./esm-chunk-95f7350d.js";import{DragAndDropUnit as t,GetClientRect as o,rectBlz as i}from"./esm-dragAndDropHelper-516f3603.js";var a,c,r,s,l,u,d=null,f=-1;function m(e,o,i){e.forEach((function(e){n(e)})),r||(r=i),l||(l=o),s||(s=new Map),d||(c=new Map,d=e),d&&d.forEach((function(n){!function(n){var e=c.get(n.dataset.column);e?(n.style.visibility="",n.classList.remove("up","down","freeze")):((e=new t(n,n.parentNode,h,".column-chooser-drag-icon-owner")).onDragStart=g,e.onDrag=x,e.onDragCancel=E,e.onDropAnimationEnd=w,c.set(n.dataset.column,e));e.Reset()}(n)})),v(),u&&(u.parentNode.removeChild(u),u=null)}function p(n){return d.find((function(e,t,o){return function(n,e){var t=y(n);return!!t&&(t.top<=e&&e<=t.bottom)}(e,n.y)}))}function h(n){var e=p(n);return e?{item:e,relativeRect:y(e)}:null}function v(){if(a&&a.style){var n=c.get(a.dataset.column);n&&n.Reset(),f=-1,a.childNodes.forEach((function(n){n.style&&(n.style.visibility="")})),a=null}}function g(n){f=d.indexOf(a=n),d.forEach((function(n){n!==a&&n.classList.add("freeze")})),a.childNodes.forEach((function(n){n.style&&(n.style.visibility="hidden")}))}function y(n){var e=s.get(n);if(e)return e;var t=o(n),a=o(l);return e=new i(t.x-a.x,t.y-a.y,t.width,t.height),s.set(n,e),e}function w(n,t){d.forEach((function(n){c.get(n.dataset.column).Stop()})),u=l.cloneNode(!0),e(u),u.style["z-index"]=2e3,l.parentNode.appendChild(u),r.invokeMethodAsync("OnElementsExchange",n.dataset.column,t.dataset.column).catch((function(n){void 0}))}function E(n){d.forEach((function(n){n.classList.remove("up","down","freeze")})),v()}function x(n,e){if(n){-1===f&&(f=d.indexOf(n));var t=p(e.centerOfDraggingObject);if(t){var o=d.indexOf(t),i=!1;d.forEach(f<o?function(n){a===n&&(i=!0),i?n.classList.add("up"):n.classList.remove("up","down"),t===n&&(i=!1)}:f>o?function(n){t===n&&(i=!0),i?n.classList.add("down"):n.classList.remove("up","down"),a===n&&(i=!1)}:function(n){n.classList.remove("up","down")})}}}function D(){d.forEach((function(n){var e,t;void((t=c.get((e=n).dataset.column))&&(c.delete(e.dataset.column),t.Dispose()))})),d=null,a=null,f=-1,l=null,s=null,c=null,r=null,u&&(u.parentNode.removeChild(u),u=null)}const L={Init:m,Dispose:D};export default L;export{D as Dispose,m as Init};
