import"./esm-chunk-eaca7b99.js";import{SetInputAttribute as e,elementIsInDOM as t,EnsureElement as o,GetParentByClassName as n,SetPositionOfDropDown as r,AttachEventToElement as u,DetachEventFromElement as s}from"./esm-dom-utils-0302a1f6.js";import"./esm-chunk-5735fd9a.js";import{D as a,R as i}from"./esm-chunk-b0b509fc.js";import{T as c}from"./esm-chunk-95f7350d.js";import{K as f}from"./esm-chunk-6d4715b2.js";import"./esm-chunk-95f069f9.js";import"./esm-popup-utils-bda5791c.js";import{OnOutsideClick as d,IsDropDownVisible as l}from"./esm-dropdowns-814f3126.js";import{a as m,H as p,G as v}from"./esm-chunk-f341cf20.js";import{K as y,a as k}from"./esm-chunk-511b3c8e.js";function h(e){!function(e){if(!t(e))return;var o=function(e){var t=e.querySelector("*[id$='_LB']");t||(t=e.parentNode.querySelector("*[id$='_LB']"));t||(t=e);if(t){var o=t.querySelector(m.ListBoxFocusedItem);if(o)return o.parentNode}return null}(e);if(o){var n=e,r=n.scrollTop+n.clientHeight<o.offsetTop+o.offsetHeight;n.scrollTop>o.offsetTop&&(n.scrollTop=o.offsetTop),r&&(n.scrollTop=o.offsetTop-(n.clientHeight-o.offsetHeight))}}(L(e))}function T(t,o,n){e(t,"value",o),g(t),n&&function(e){e&&e.select()}(t)}function g(e){e.previousSibling.innerText=""==e.value&&e.placeholder?e.placeholder:e.value}function w(e){e=o(e),document.activeElement===e&&b(e)}function C(e,t){var o=e.target;I(o,!0),function(e){if(e){var t=n(e,"form-control");t.dataset.bluredClass&&(t.className=t.dataset.bluredClass)}}(o),o.dataset.timerId=window.setTimeout((function(){if(delete o.dataset.timerId,document.activeElement!==o)try{K(t,o)}catch(e){}}),200)}function I(e,t){e.dataset.timerId&&(clearTimeout(e.dataset.timerId),delete e.dataset.timerId),t||window.setTimeout((function(){I(e,!0)}),100)}function b(e){if(e){var t=n(e,"form-control");t.dataset.focusedClass&&(t.className=t.dataset.focusedClass)}}function j(e,t){return t&&y(e),function(e){return D(e)}(e)&&(e.stopPropagation(),e.preventDefault()),!1}function F(e,t,o,n){var r=!1;if(n&&(r=r||k(e)),r=r||function(e){var t=e.altKey&&(e.keyCode==f.Down||e.keyCode==f.Up),o=D(e),n=e.keyCode==f.Esc||e.keyCode==f.Enter,r=function(e){var t=0==e.target.value.length;return e.keyCode==f.Backspace&&t}(e);return t||o||n||r}(e)){var u=e.target.value,s=""!=e.target.dataset.previousValue;if(o&&p(o)){var a=v(o,!1);t.invokeMethodAsync("OnTagBoxListBoxKeyUp",u,e.keyCode,e.altKey,e.ctrlKey,a.itemHeight,a.scrollTopForRequest,a.scrollHeightForRequest,s)}else t.invokeMethodAsync("OnTagBoxKeyUp",u,e.keyCode,e.altKey,e.ctrlKey,s)}}function D(e){return e.keyCode===f.Down||e.keyCode===f.Up||e.keyCode===f.PageUp||e.keyCode===f.PageDown||e.ctrlKey&&(e.keyCode===f.Home||e.keyCode===f.End)}function K(e,t,o){if(t){var n=(new Date).getTime();t.dataset.lastLostFocusTime&&n-t.dataset.lastLostFocusTime<300&&!o||(t.dataset.lastLostFocusTime=(new Date).getTime(),document.activeElement!=t&&(t.value=""),e.invokeMethodAsync("OnTagBoxLostFocus",t.value))}}function L(e){return(e=o(e)).querySelector("div.dxbs-dm.dropdown-menu")}function x(e,n,f,m,p){if(e=o(e)){a(e),m="true"===m.toLowerCase(),p="true"===p.toLowerCase(),n=o(n);var v=L(e);r(e,v);var y=v;p&&h(e);var k=function(e){return j(e,m)},T=function(e){return F(e,f,y,m)},w=function(e){return function(e,t){b(e.target)}(e)},D=function(e){return C(e,f)},x=function(e){return g(e.target)},E=function(e){return I(n)},B=function(o){return d(o,e,(function(){t(e)||a(e);var o=document.activeElement===n,r=n.dataset.timerId>0,u=v&&l(v);I(n),(o||r||u)&&K(f,n,!0)}))};return u(n,"keydown",k),u(n,"keyup",T),u(n,"focus",w),u(n,"blur",D),u(n,"input",x),u(e,"mousedown",E),u(document,c.touchMouseDownEventName,B),i(e,(function(){s(n,"keydown",k),s(n,"keyup",T),s(n,"focus",w),s(n,"blur",D),s(n,"input",x),s(e,"mousedown",E),s(document,c.touchMouseDownEventName,B)})),g(n),Promise.resolve("ok")}}function E(e){if(e=o(e))return a(e),Promise.resolve("ok")}const B={Init:x,Dispose:E,PrepareInputIfFocused:w,ScrollToFocusedItem:h,FitInputWidth:g,ForceInputValue:T};export default B;export{E as Dispose,g as FitInputWidth,T as ForceInputValue,x as Init,w as PrepareInputIfFocused,h as ScrollToFocusedItem};
