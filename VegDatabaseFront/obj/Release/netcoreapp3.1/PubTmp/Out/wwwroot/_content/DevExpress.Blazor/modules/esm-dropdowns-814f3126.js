import"./esm-chunk-eaca7b99.js";import{EnsureElement as e,AttachEventToElement as t,GetParentByClassName as n,SetPositionOfDropDown as o,changeDom as r,elementIsInDOM as i,DetachEventFromElement as u,RequestAnimationFrame as c}from"./esm-dom-utils-0302a1f6.js";import{w as a}from"./esm-chunk-5735fd9a.js";import{D as s,R as l}from"./esm-chunk-b0b509fc.js";import{T as d}from"./esm-chunk-95f7350d.js";import{K as m}from"./esm-chunk-6d4715b2.js";import"./esm-chunk-95f069f9.js";import{show as f}from"./esm-popup-utils-bda5791c.js";const v=0,h=1,p=[{value:0,text:""},{value:1,text:"above"},{value:2,text:"below"},{value:4,text:"top-sides"},{value:8,text:"bottom-sides"},{value:16,text:"outside-left"},{value:32,text:"outside-right"},{value:64,text:"left-sides"},{value:128,text:"right-sides"}];function g(e,t,n){for(var o=e.target;o;){if(o===t)return!1;o=o.parentElement}n&&n()}function E(e){return"none"!==e.style.display}const b="a[href], input:not([disabled]), button:not([disabled]), [tabindex]:not([tabindex='-1'])";function w(e,t){var n,o;e===h&&(t?(n="auto",o="yes"):(n="hidden",o="no"),document.documentElement.style.overflow=n,document.body.style.overflow=n,document.body.scroll=o)}const y={Init:function(n,o,r,c){if(n=e(n),o=e(o),r=e(r),n){if(s(n),r){var a=function(e){return g(e,n,(function(){i(n)||s(n);var e=document.activeElement===o,t=r&&E(r);(e||t)&&c.invokeMethodAsync("OnDropDownLostFocus",o.value)}))};t(document,d.touchMouseDownEventName,a),l(n,(function(){u(document,d.touchMouseDownEventName,a)}))}return Promise.resolve("ok")}},Dispose:function(t){return(t=e(t))&&s(t),Promise.resolve("ok")},ShowAdaptiveDropdown:function(t,i,u,s,l){t=e(t);var g=n(t,u);if(g){g.querySelector("."+s);var E=document.documentElement,y=i.dialogType,D=i.alignment,x=y===h;y===v&&(0===D?o(g,t):f(t,g,function(e){var t="";return p.forEach(n=>{0!=(n.value&e)&&(t&&(t+=" "),t+=n.text)}),t}(D)));var L=!1;return E.addEventListener(d.touchMouseDownEventName,k),t.addEventListener("keydown",(function(e){e.keyCode===m.Esc&&T()})),t.addEventListener("focusout",(function(e){var n,o,r,i;L||(null===e.relatedTarget||t.contains(e.relatedTarget)?null===e.relatedTarget&&E.addEventListener("focusin",N):void((n=t.compareDocumentPosition(e.relatedTarget))&Node.DOCUMENT_POSITION_PRECEDING?(r=t,i=r.querySelectorAll(b),o=i[i.length-1],void(o&&o.focus())):n&Node.DOCUMENT_POSITION_FOLLOWING&&H()))})),function(e,t,o,r){e&&t.addEventListener("touchmove",e=>{e.srcElement===t&&e.preventDefault()});if(r===h){var i=null;o.addEventListener("touchstart",e=>{i=e}),o.addEventListener("touchmove",e=>{(function(e,t){if(n(e.srcElement,"modal-header"))return!0;var o=n(e.srcElement,"column-chooser-elements-container"),r=n(o,"modal-body");if(!o||!r)return!1;if(r.clientHeight>=o.clientHeight)return!0;var i=e.touches[0].pageY-t.touches[0].pageY,u=function(e){return e.getBoundingClientRect().top},c=o.querySelector(".column-chooser-element-container");if(c&&u(c)===u(r)&&i>=0&&e.cancelable)return!0;var a=function(e){return Math.round(e.getBoundingClientRect().bottom)},s=o.querySelector(".column-chooser-element-container:last-child");if(s&&a(s)===a(r)&&i<=0&&e.cancelable)return!0})(e,i)&&e.preventDefault(),i=e})}}(x,t,g,y),a(t).then(()=>{C()}),w(y,!1),y===v?r(H):(window.addEventListener("resize",M),M()),Promise.resolve()}function k(e){(!t.contains(e.srcElement)||y===h&&t===e.srcElement)&&T()}function N(e){E.removeEventListener("focusin",N),null===e.relatedTarget&&e.target&&t.contains(e.target)&&e.target.focus()}function T(){L||(L=!0,C(),l.invokeMethodAsync("CloseDialog"))}function C(){E.removeEventListener(d.touchMouseDownEventName,k),window.removeEventListener("resize",M),w(y,!0)}function H(){var e=t.querySelector(b);e&&e.focus()}function M(){if(n(t,"modal-dialog-owner")){var e=t.firstElementChild.classList,o=n(t,"column-chooser-button-owner")&&function(e,t,o){if(o!==h)return;var r=e.getBoundingClientRect(),i=t.getBoundingClientRect(),u=n(e,"dxbs-gridview"),c=u&&u.querySelector("thead");if(!c)return;var a=c.getBoundingClientRect(),s=(a||r).bottom;if(s>.5*t.clientHeight)return s-r.top<.5*t.clientHeight?s-i.top-.5*t.clientHeight:r.top-i.top-2}(g,E,y),r=E.clientHeight>E.clientWidth?"topVertical":"topHorizontal";c((function(){e.contains("topVertical")||e.contains("topHorizontal")?e.remove("transition"):e.add("transition"),o&&(E.scrollTop=o),e.remove("topVertical","topHorizontal"),e.add(r)}))}}}};export default y;export{E as IsDropDownVisible,g as OnOutsideClick};
